<!DOCTYPE html>
<html>
<head>
    <title>Data Lineage Visualization</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style type="text/css">
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
        #network { width: 100%; height: 600px; border: 1px solid lightgray; }
        #info-panel { margin-top: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .model-info { background-color: #f9f9f9; padding: 10px; margin: 10px 0; border-radius: 3px; }
        .column-list { max-height: 200px; overflow-y: auto; }
        .control-panel { margin-bottom: 20px; padding: 10px; background-color: #f0f0f0; border-radius: 5px; }
        button { margin: 5px; padding: 8px 15px; cursor: pointer; }
        select { margin: 5px; padding: 5px; }
        .legend { margin: 10px 0; }
        .legend-item { display: inline-block; margin: 5px 10px; }
        .legend-color { display: inline-block; width: 20px; height: 20px; margin-right: 5px; vertical-align: middle; }
    </style>
</head>
<body>
    <h1>Data Lineage Visualization</h1>
    
    <div class="control-panel">
        <button onclick="fitNetwork()">Fit to Screen</button>
        <button onclick="showAllNodes()">Show All</button>
        <select id="layerFilter" onchange="filterByLayer()">
            <option value="">All Layers</option>
            <option value="bronze">Bronze</option>
            <option value="silver">Silver</option>
            <option value="gold">Gold</option>
            <option value="cte">CTE</option>
        </select>
        <select id="modelSelect" onchange="focusOnModel()">
            <option value="">Select Model</option>
        </select>
    </div>
    
    <div class="legend">
        <div class="legend-item">
            <span class="legend-color" style="background-color: #87CEEB;"></span>Bronze Layer
        </div>
        <div class="legend-item">
            <span class="legend-color" style="background-color: #98FB98;"></span>Silver Layer
        </div>
        <div class="legend-item">
            <span class="legend-color" style="background-color: #FFD700;"></span>Gold Layer
        </div>
        <div class="legend-item">
            <span class="legend-color" style="background-color: #D3D3D3;"></span>CTE
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="info-panel">
        <h3>Model Information</h3>
        <div id="model-details">Click on a node to see model details</div>
    </div>

    <script type="text/javascript">
        var nodes = new vis.DataSet([{"id": "fct_forecastitem", "label": "fct_forecastitem", "title": "<b>fct_forecastitem</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast item data from source system<br>Columns: 18", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_demandstorage", "label": "fct_demandstorage", "title": "<b>fct_demandstorage</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: demand<br>Description: Raw demand storage fact table from source system<br>Columns: 5", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_ForecastCycle", "label": "fct_ForecastCycle", "title": "<b>fct_ForecastCycle</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast cycle data from source system<br>Columns: 3", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "IndustryTable", "label": "IndustryTable", "title": "<b>IndustryTable</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: industry<br>Description: Raw industry reference data from source system<br>Columns: 6", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_ForeCastGroup", "label": "fct_ForeCastGroup", "title": "<b>fct_ForeCastGroup</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast group data from source system<br>Columns: 2", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTGROUP_silver_product", "label": "FCT_FORECASTGROUP_silver_product", "title": "<b>FCT_FORECASTGROUP_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast groups<br>Columns: 2", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_DEMANDSTORAGE_silver_product", "label": "FCT_DEMANDSTORAGE_silver_product", "title": "<b>FCT_DEMANDSTORAGE_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized demand storage<br>Columns: 5", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_product", "label": "FCT_FORECASTITEM_silver_product", "title": "<b>FCT_FORECASTITEM_silver_product</b><br>Layer: silver<br>Kind: TABLE<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast items<br>Columns: 18", "group": "silver", "shape": "box", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTCYCLE_silver_product", "label": "FCT_FORECASTCYCLE_silver_product", "title": "<b>FCT_FORECASTCYCLE_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast cycles<br>Columns: 3", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_industry", "label": "FCT_FORECASTITEM_silver_industry", "title": "<b>FCT_FORECASTITEM_silver_industry</b><br>Layer: silver<br>Kind: VIEW<br>Owner: industry_team<br>Domain: industry<br>Description: Industry vertical silver layer - adds industry-specific attributes to forecast items<br>Columns: 11", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTCYCLE_silver_industry", "label": "FCT_FORECASTCYCLE_silver_industry", "title": "<b>FCT_FORECASTCYCLE_silver_industry</b><br>Layer: silver<br>Kind: VIEW<br>Owner: industry_team<br>Domain: industry<br>Description: Industry vertical silver layer - adds industry-specific forecast cycle attributes<br>Columns: 4", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "industry_values_cte", "label": "industry_values_cte", "title": "<b>industry_values_cte</b><br>Layer: cte<br>Kind: CTE<br>Owner: industry_team<br>Domain: industry<br>Description: CTE for industry-specific values and alternative subregion mapping<br>Columns: 5", "group": "cte", "shape": "diamond", "color": "#D3D3D3", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_customer", "label": "FCT_FORECASTITEM_silver_customer", "title": "<b>FCT_FORECASTITEM_silver_customer</b><br>Layer: silver<br>Kind: VIEW<br>Owner: customer_team<br>Domain: customer<br>Description: Customer vertical silver layer - applies customer-specific filtering to industry data<br>Columns: 11", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "customer_industry_values_cte", "label": "customer_industry_values_cte", "title": "<b>customer_industry_values_cte</b><br>Layer: cte<br>Kind: CTE<br>Owner: customer_team<br>Domain: customer<br>Description: CTE for industry values filtered for customer-specific records<br>Columns: 5", "group": "cte", "shape": "diamond", "color": "#D3D3D3", "font": {"size": 12}, "physics": true}, {"id": "FCT_DEMAND_SUMMARY_gold_customer", "label": "FCT_DEMAND_SUMMARY_gold_customer", "title": "<b>FCT_DEMAND_SUMMARY_gold_customer</b><br>Layer: gold<br>Kind: TABLE<br>Owner: customer_analytics_team<br>Domain: customer<br>Description: Customer demand summary aggregated by month and customer segment<br>Columns: 9", "group": "gold", "shape": "box", "color": "#FFD700", "font": {"size": 12}, "physics": true}]);
        var edges = new vis.DataSet([{"id": 0, "from": "fct_ForeCastGroup", "to": "FCT_FORECASTGROUP_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForeCastGroup \u2192 FCT_FORECASTGROUP_silver_product"}, {"id": 1, "from": "fct_demandstorage", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_demandstorage \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 2, "from": "fct_ForecastCycle", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForecastCycle \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 3, "from": "fct_ForeCastGroup", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForeCastGroup \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 4, "from": "fct_forecastitem", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 5, "from": "fct_forecastitem", "to": "FCT_FORECASTITEM_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_FORECASTITEM_silver_product"}, {"id": 6, "from": "fct_ForecastCycle", "to": "FCT_FORECASTCYCLE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForecastCycle \u2192 FCT_FORECASTCYCLE_silver_product"}, {"id": 7, "from": "FCT_FORECASTITEM_silver_product", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_product \u2192 FCT_FORECASTITEM_silver_industry"}, {"id": 8, "from": "IndustryTable", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 FCT_FORECASTITEM_silver_industry"}, {"id": 9, "from": "industry_values_cte", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#2E86C1"}, "width": 2, "title": "industry_values_cte \u2192 FCT_FORECASTITEM_silver_industry (CTE)", "dashes": true}, {"id": 10, "from": "FCT_FORECASTCYCLE_silver_product", "to": "FCT_FORECASTCYCLE_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTCYCLE_silver_product \u2192 FCT_FORECASTCYCLE_silver_industry"}, {"id": 11, "from": "IndustryTable", "to": "industry_values_cte", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 industry_values_cte"}, {"id": 12, "from": "FCT_FORECASTITEM_silver_industry", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_industry \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 13, "from": "fct_forecastitem", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 14, "from": "IndustryTable", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 15, "from": "customer_industry_values_cte", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#2E86C1"}, "width": 2, "title": "customer_industry_values_cte \u2192 FCT_FORECASTITEM_silver_customer (CTE)", "dashes": true}, {"id": 16, "from": "IndustryTable", "to": "customer_industry_values_cte", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 customer_industry_values_cte"}, {"id": 17, "from": "FCT_DEMANDSTORAGE_silver_product", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_DEMANDSTORAGE_silver_product \u2192 FCT_DEMAND_SUMMARY_gold_customer"}, {"id": 18, "from": "FCT_FORECASTCYCLE_silver_industry", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTCYCLE_silver_industry \u2192 FCT_DEMAND_SUMMARY_gold_customer"}, {"id": 19, "from": "FCT_FORECASTITEM_silver_customer", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_customer \u2192 FCT_DEMAND_SUMMARY_gold_customer"}]);
        var modelsInfo = {"fct_forecastitem": {"name": "fct_forecastitem", "description": "Raw forecast item data from source system", "layer": "bronze", "kind": "TABLE", "owner": "data_engineering", "domain": "tbd", "tags": ["forecast", "item", "bronze", "raw"], "refresh_frequency": "daily", "depends_on": ["raw.fct_forecastitem"], "base_table": "raw.fct_forecastitem", "columns": [{"name": "FK_ITEMSEGMENTATION_ID", "data_type": "INTEGER", "description": "Foreign key to item segmentation dimension", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "FK_NODESEGMENTATION_ID", "data_type": "INTEGER", "description": "Foreign key to node segmentation dimension", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "FORECASTITEMID", "data_type": "VARCHAR(50)", "description": "Business key for forecast item", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "PRODUCTID", "data_type": "VARCHAR(50)", "description": "Product identifier", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "CURRENCYID", "data_type": "VARCHAR(3)", "description": "Currency code (ISO 3-letter format)", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "CUSTOMERID", "data_type": "VARCHAR(50)", "description": "Customer identifier", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "BUSINESSSEGMENTID", "data_type": "VARCHAR(50)", "description": "Business segment identifier", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "COUNTRY", "data_type": "VARCHAR(3)", "description": "Country code (ISO 3-letter format)", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "PRIORITY", "data_type": "INTEGER", "description": "Priority level for forecast item", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "ULTIMATEDESTINATION", "data_type": "VARCHAR(100)", "description": "Ultimate destination location for shipment", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "CUSTOMERSEGMENT", "data_type": "VARCHAR(50)", "description": "Customer segment classification", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "CUSTOMER_PRIORITY", "data_type": "INTEGER", "description": "Customer-specific priority level", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "DEMANDFAMILY", "data_type": "VARCHAR(50)", "description": "Demand family classification", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "FORECASTTYPEID", "data_type": "VARCHAR(20)", "description": "Forecast type identifier", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "LOCATIONID", "data_type": "VARCHAR(50)", "description": "Location identifier", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "SUBREGION", "data_type": "VARCHAR(50)", "description": "Subregion classification", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "DERIVEDLOB", "data_type": "VARCHAR(50)", "description": "Derived line of business classification", "reference_table": "raw.fct_forecastitem", "expression": ""}, {"name": "Tempflag", "data_type": "INTEGER", "description": "Temporary flag for data processing (0=permanent, 1=temporary)", "reference_table": "raw.fct_forecastitem", "expression": ""}], "audits": [], "grain": []}, "fct_demandstorage": {"name": "fct_demandstorage", "description": "Raw demand storage fact table from source system", "layer": "bronze", "kind": "TABLE", "owner": "data_engineering", "domain": "demand", "tags": ["demand", "forecast", "storage", "bronze", "raw"], "refresh_frequency": "daily", "depends_on": ["raw.fct_demandstorage"], "base_table": "raw.fct_demandstorage", "columns": [{"name": "BASEQUANTITY", "data_type": "DECIMAL(18,2)", "description": "Base quantity of demand", "reference_table": "raw.fct_demandstorage", "expression": ""}, {"name": "CalculatedQuantity", "data_type": "DECIMAL(18,2)", "description": "Calculated quantity after adjustments", "reference_table": "raw.fct_demandstorage", "expression": ""}, {"name": "ForecastCycleId", "data_type": "INTEGER", "description": "Identifier for the forecast cycle", "reference_table": "raw.fct_demandstorage", "expression": ""}, {"name": "ForecastGroupId", "data_type": "INTEGER", "description": "Identifier for the forecast group", "reference_table": "raw.fct_demandstorage", "expression": ""}, {"name": "ForecastItem_Id", "data_type": "INTEGER", "description": "Identifier for the forecast item", "reference_table": "raw.fct_demandstorage", "expression": ""}], "audits": [], "grain": []}, "fct_ForecastCycle": {"name": "fct_ForecastCycle", "description": "Raw forecast cycle data from source system", "layer": "bronze", "kind": "TABLE", "owner": "data_engineering", "domain": "tbd", "tags": ["forecast", "cycle", "bronze", "raw"], "refresh_frequency": "daily", "depends_on": ["raw.fct_ForecastCycle"], "base_table": "raw.fct_ForecastCycle", "columns": [{"name": "ForecastCycleId", "data_type": "INTEGER", "description": "Unique identifier for forecast cycle", "reference_table": "raw.fct_ForecastCycle", "expression": ""}, {"name": "PeriodEnd", "data_type": "DATE", "description": "End date of the forecast period", "reference_table": "raw.fct_ForecastCycle", "expression": ""}, {"name": "PeriodStart", "data_type": "DATE", "description": "Start date of the forecast period", "reference_table": "raw.fct_ForecastCycle", "expression": ""}], "audits": [], "grain": []}, "IndustryTable": {"name": "IndustryTable", "description": "Raw industry reference data from source system", "layer": "bronze", "kind": "TABLE", "owner": "data_engineering", "domain": "industry", "tags": ["industry", "reference", "bronze", "raw"], "refresh_frequency": "weekly", "depends_on": ["raw.IndustryTable"], "base_table": "raw.IndustryTable", "columns": [{"name": "FORECASTITEMID", "data_type": "VARCHAR(50)", "description": "Forecast item identifier for joining", "reference_table": "raw.IndustryTable", "expression": ""}, {"name": "value1", "data_type": "VARCHAR(255)", "description": "Industry value 1", "reference_table": "raw.IndustryTable", "expression": ""}, {"name": "Value2", "data_type": "VARCHAR(255)", "description": "Industry value 2", "reference_table": "raw.IndustryTable", "expression": ""}, {"name": "Value3", "data_type": "VARCHAR(255)", "description": "Industry value 3", "reference_table": "raw.IndustryTable", "expression": ""}, {"name": "Alterative_subregion", "data_type": "VARCHAR(50)", "description": "Alternative subregion classification", "reference_table": "raw.IndustryTable", "expression": ""}, {"name": "customerflag", "data_type": "INTEGER", "description": "Flag indicating customer-specific records", "reference_table": "raw.IndustryTable", "expression": ""}], "audits": [], "grain": []}, "fct_ForeCastGroup": {"name": "fct_ForeCastGroup", "description": "Raw forecast group data from source system", "layer": "bronze", "kind": "TABLE", "owner": "data_engineering", "domain": "tbd", "tags": ["forecast", "group", "bronze", "raw"], "refresh_frequency": "daily", "depends_on": ["raw.fct_ForeCastGroup"], "base_table": "raw.fct_ForeCastGroup", "columns": [{"name": "ForecastGroupId", "data_type": "INTEGER", "description": "Unique identifier for forecast group", "reference_table": "raw.fct_ForeCastGroup", "expression": ""}, {"name": "Label", "data_type": "VARCHAR(255)", "description": "Descriptive label for the forecast group", "reference_table": "raw.fct_ForeCastGroup", "expression": ""}], "audits": [], "grain": []}, "FCT_FORECASTGROUP_silver_product": {"name": "FCT_FORECASTGROUP_silver_product", "description": "Product vertical silver layer - standardized forecast groups", "layer": "silver", "kind": "VIEW", "owner": "product_team", "domain": "product", "tags": ["forecast", "group", "dimension", "silver", "product"], "refresh_frequency": "daily", "depends_on": ["fct_ForeCastGroup"], "base_table": "fct_ForeCastGroup", "columns": [{"name": "ForecastGroup_Id", "data_type": "INTEGER", "description": "Standardized forecast group identifier", "reference_table": "fct_ForeCastGroup", "expression": "ForecastGroupId"}, {"name": "Label", "data_type": "VARCHAR(255)", "description": "Label for the forecast group", "reference_table": "fct_ForeCastGroup", "expression": "ForecastGroupId"}], "audits": [], "grain": ["ForecastGroup_Id"]}, "FCT_DEMANDSTORAGE_silver_product": {"name": "FCT_DEMANDSTORAGE_silver_product", "description": "Product vertical silver layer - standardized demand storage", "layer": "silver", "kind": "VIEW", "owner": "product_team", "domain": "product", "tags": ["demand", "forecast", "storage", "silver", "product"], "refresh_frequency": "daily", "depends_on": ["fct_demandstorage", "fct_ForecastCycle", "fct_ForeCastGroup", "fct_forecastitem"], "base_table": "fct_demandstorage", "columns": [{"name": "BASEQUANTITY", "data_type": "DECIMAL(18,2)", "description": "Base quantity for demand forecast", "reference_table": "fct_demandstorage", "expression": "BASEQUANTITY"}, {"name": "CalculatedQuantity", "data_type": "DECIMAL(18,2)", "description": "Calculated quantity after adjustments", "reference_table": "fct_demandstorage", "expression": "CalculatedQuantity"}, {"name": "ForecastCycle_Id", "data_type": "INTEGER", "description": "Standardized forecast cycle identifier", "reference_table": "fct_demandstorage", "expression": "ForecastCycleId"}, {"name": "ForecastGroup_Id", "data_type": "INTEGER", "description": "Standardized forecast group identifier", "reference_table": "fct_demandstorage", "expression": "ForecastGroupId"}, {"name": "ForecastItemId", "data_type": "INTEGER", "description": "Standardized forecast item identifier", "reference_table": "fct_demandstorage", "expression": "ForecastItem_Id"}], "audits": [], "grain": ["ForecastCycle_Id", "ForecastGroup_Id", "ForecastItemId"]}, "FCT_FORECASTITEM_silver_product": {"name": "FCT_FORECASTITEM_silver_product", "description": "Product vertical silver layer - standardized forecast items", "layer": "silver", "kind": "TABLE", "owner": "product_team", "domain": "product", "tags": ["forecast", "item", "dimension", "silver", "product"], "refresh_frequency": "daily", "depends_on": ["fct_forecastitem"], "base_table": "fct_forecastitem", "columns": [{"name": "PK_FORECASTITEM_ID", "data_type": "INTEGER", "description": "Generated primary key for forecast item", "reference_table": "fct_forecastitem", "expression": "@newpk()"}, {"name": "FK_ITEMSEGMENTATION_ID", "data_type": "INTEGER", "description": "Foreign key to item segmentation", "reference_table": "fct_forecastitem", "expression": "FK_ITEMSEGMENTATION_ID"}, {"name": "FK_NODESEGMENTATION_ID", "data_type": "INTEGER", "description": "Foreign key to node segmentation", "reference_table": "fct_forecastitem", "expression": "FK_NODESEGMENTATION_ID"}, {"name": "FORECASTITEMID", "data_type": "VARCHAR(50)", "description": "Business key for forecast item", "reference_table": "fct_forecastitem", "expression": "FORECASTITEMID"}, {"name": "PRODUCTID", "data_type": "VARCHAR(50)", "description": "Product identifier", "reference_table": "fct_forecastitem", "expression": "PRODUCTID"}, {"name": "CURRENCYID", "data_type": "VARCHAR(3)", "description": "Currency code", "reference_table": "fct_forecastitem", "expression": "CURRENCYID"}, {"name": "CUSTOMERID", "data_type": "VARCHAR(50)", "description": "Customer identifier", "reference_table": "fct_forecastitem", "expression": "CUSTOMERID"}, {"name": "BUSINESSSEGMENTID", "data_type": "VARCHAR(50)", "description": "Business segment identifier", "reference_table": "fct_forecastitem", "expression": "BUSINESSSEGMENTID"}, {"name": "COUNTRY", "data_type": "VARCHAR(3)", "description": "Country code", "reference_table": "fct_forecastitem", "expression": "COUNTRY"}, {"name": "PRIORITY", "data_type": "INTEGER", "description": "Priority level", "reference_table": "fct_forecastitem", "expression": "PRIORITY"}, {"name": "ULTIMATEDESTINATION", "data_type": "VARCHAR(100)", "description": "Ultimate destination location", "reference_table": "fct_forecastitem", "expression": "ULTIMATEDESTINATION"}, {"name": "CUSTOMERSEGMENT", "data_type": "VARCHAR(50)", "description": "Customer segment classification", "reference_table": "fct_forecastitem", "expression": "CUSTOMERSEGMENT"}, {"name": "CUSTOMER_PRIORITY", "data_type": "INTEGER", "description": "Customer priority level", "reference_table": "fct_forecastitem", "expression": "CUSTOMER_PRIORITY"}, {"name": "DEMANDFAMILY", "data_type": "VARCHAR(50)", "description": "Demand family classification", "reference_table": "fct_forecastitem", "expression": "DEMANDFAMILY"}, {"name": "FORECASTTYPEID", "data_type": "VARCHAR(20)", "description": "Forecast type identifier", "reference_table": "fct_forecastitem", "expression": "FORECASTTYPEID"}, {"name": "LOCATIONID", "data_type": "VARCHAR(50)", "description": "Location identifier", "reference_table": "fct_forecastitem", "expression": "LOCATIONID"}, {"name": "SUBREGION", "data_type": "VARCHAR(50)", "description": "Subregion classification", "reference_table": "fct_forecastitem", "expression": "SUBREGION"}, {"name": "DERIVEDLOB", "data_type": "VARCHAR(50)", "description": "Derived line of business", "reference_table": "fct_forecastitem", "expression": "DERIVEDLOB"}], "audits": [], "grain": ["PK_FORECASTITEM_ID"]}, "FCT_FORECASTCYCLE_silver_product": {"name": "FCT_FORECASTCYCLE_silver_product", "description": "Product vertical silver layer - standardized forecast cycles", "layer": "silver", "kind": "VIEW", "owner": "product_team", "domain": "product", "tags": ["forecast", "cycle", "dimension", "silver", "product"], "refresh_frequency": "daily", "depends_on": ["fct_ForecastCycle"], "base_table": "fct_ForecastCycle", "columns": [{"name": "ForecastCycle_Id", "data_type": "INTEGER", "description": "Standardized forecast cycle identifier", "reference_table": "fct_ForecastCycle", "expression": "ForecastCycleId"}, {"name": "PeriodEnd", "data_type": "DATE", "description": "End date of the forecast period", "reference_table": "fct_ForecastCycle", "expression": "PeriodEnd"}, {"name": "PeriodStart", "data_type": "DATE", "description": "Start date of the forecast period", "reference_table": "fct_ForecastCycle", "expression": "PeriodStart"}], "audits": [], "grain": ["ForecastCycle_Id"]}, "FCT_FORECASTITEM_silver_industry": {"name": "FCT_FORECASTITEM_silver_industry", "description": "Industry vertical silver layer - adds industry-specific attributes to forecast items", "layer": "silver", "kind": "VIEW", "owner": "industry_team", "domain": "industry", "tags": ["forecast", "item", "dimension", "silver", "industry"], "refresh_frequency": "daily", "depends_on": ["FCT_FORECASTITEM_silver_product", "IndustryTable", "industry_values_cte"], "base_table": "FCT_FORECASTITEM_silver_product", "columns": [{"name": "PK_FORECASTITEM_ID", "data_type": "INTEGER", "description": "Primary key for forecast item", "reference_table": "FCT_FORECASTITEM_silver_product", "expression": "PK_FORECASTITEM_ID"}, {"name": "FORECASTITEMID", "data_type": "VARCHAR(50)", "description": "Business key for forecast item", "reference_table": "FCT_FORECASTITEM_silver_product", "expression": "FORECASTITEMID"}, {"name": "PRODUCTID", "data_type": "VARCHAR(50)", "description": "Product identifier", "reference_table": "FCT_FORECASTITEM_silver_product", "expression": "PRODUCTID"}, {"name": "CUSTOMERID", "data_type": "VARCHAR(50)", "description": "Customer identifier", "reference_table": "FCT_FORECASTITEM_silver_product", "expression": "CUSTOMERID"}, {"name": "COUNTRY", "data_type": "VARCHAR(3)", "description": "Country code", "reference_table": "FCT_FORECASTITEM_silver_product", "expression": "COUNTRY"}, {"name": "CUSTOMERSEGMENT", "data_type": "VARCHAR(50)", "description": "Customer segment classification", "reference_table": "FCT_FORECASTITEM_silver_product", "expression": "CUSTOMERSEGMENT"}, {"name": "DEMANDFAMILY", "data_type": "VARCHAR(50)", "description": "Demand family classification", "reference_table": "FCT_FORECASTITEM_silver_product", "expression": "DEMANDFAMILY"}, {"name": "SUBREGION", "data_type": "VARCHAR(50)", "description": "Industry-specific subregion classification", "reference_table": "industry_values_cte", "expression": "Alterative_subregion"}, {"name": "INDUSTRY1_COLUMN1", "data_type": "VARCHAR(255)", "description": "Industry-specific value 1", "reference_table": "industry_values_cte", "expression": "value1"}, {"name": "INDUSTRY1_COLUMN2", "data_type": "VARCHAR(255)", "description": "Industry-specific value 2", "reference_table": "industry_values_cte", "expression": "value2"}, {"name": "INDUSTRY1_COLUMN3", "data_type": "VARCHAR(255)", "description": "Industry-specific value 3 (only when bias_calc feature is enabled)", "reference_table": "industry_values_cte", "expression": "CASE WHEN @Feature('bias_calc') = 1 THEN value3 ELSE NULL END"}], "audits": [], "grain": ["PK_FORECASTITEM_ID"]}, "FCT_FORECASTCYCLE_silver_industry": {"name": "FCT_FORECASTCYCLE_silver_industry", "description": "Industry vertical silver layer - adds industry-specific forecast cycle attributes", "layer": "silver", "kind": "VIEW", "owner": "industry_team", "domain": "industry", "tags": ["forecast", "cycle", "dimension", "silver", "industry"], "refresh_frequency": "daily", "depends_on": ["FCT_FORECASTCYCLE_silver_product"], "base_table": "FCT_FORECASTCYCLE_silver_product", "columns": [{"name": "ForecastCycle_Id", "data_type": "INTEGER", "description": "Forecast cycle identifier", "reference_table": "FCT_FORECASTCYCLE_silver_product", "expression": "ForecastCycle_Id"}, {"name": "PeriodEnd", "data_type": "DATE", "description": "End date of the forecast period", "reference_table": "FCT_FORECASTCYCLE_silver_product", "expression": "PeriodEnd"}, {"name": "PeriodStart", "data_type": "DATE", "description": "Start date of the forecast period", "reference_table": "FCT_FORECASTCYCLE_silver_product", "expression": "PeriodStart"}, {"name": "ForecastCycle_Label", "data_type": "VARCHAR(7)", "description": "Industry-standard forecast cycle label (YYYY-MM format)", "reference_table": "FCT_FORECASTCYCLE_silver_product", "expression": "FORMAT(PeriodEnd, 'yyyy-MM')"}], "audits": [], "grain": ["ForecastCycle_Id"]}, "industry_values_cte": {"name": "industry_values_cte", "description": "CTE for industry-specific values and alternative subregion mapping", "layer": "cte", "kind": "CTE", "owner": "industry_team", "domain": "industry", "tags": ["industry", "cte", "values"], "refresh_frequency": "daily", "depends_on": ["IndustryTable"], "base_table": "IndustryTable", "columns": [{"name": "FORECASTITEMID", "data_type": "VARCHAR(50)", "description": "Forecast item identifier for joining", "reference_table": "IndustryTable", "expression": "FORECASTITEMID"}, {"name": "value1", "data_type": "VARCHAR(255)", "description": "Industry value 1", "reference_table": "IndustryTable", "expression": "value1"}, {"name": "value2", "data_type": "VARCHAR(255)", "description": "Industry value 2", "reference_table": "IndustryTable", "expression": "Value2"}, {"name": "value3", "data_type": "VARCHAR(255)", "description": "Industry value 3", "reference_table": "IndustryTable", "expression": "Value3"}, {"name": "Alterative_subregion", "data_type": "VARCHAR(50)", "description": "Alternative subregion classification for industry", "reference_table": "IndustryTable", "expression": "Alterative_subregion"}], "audits": [], "grain": []}, "FCT_FORECASTITEM_silver_customer": {"name": "FCT_FORECASTITEM_silver_customer", "description": "Customer vertical silver layer - applies customer-specific filtering to industry data", "layer": "silver", "kind": "VIEW", "owner": "customer_team", "domain": "customer", "tags": ["forecast", "item", "dimension", "silver", "customer", "filtered"], "refresh_frequency": "daily", "depends_on": ["FCT_FORECASTITEM_silver_industry", "fct_forecastitem", "IndustryTable", "customer_industry_values_cte"], "base_table": "FCT_FORECASTITEM_silver_industry", "columns": [{"name": "PK_FORECASTITEM_ID", "data_type": "INTEGER", "description": "Primary key for forecast item", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "PK_FORECASTITEM_ID"}, {"name": "FORECASTITEMID", "data_type": "VARCHAR(50)", "description": "Business key for forecast item", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "FORECASTITEMID"}, {"name": "PRODUCTID", "data_type": "VARCHAR(50)", "description": "Product identifier", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "PRODUCTID"}, {"name": "CUSTOMERID", "data_type": "VARCHAR(50)", "description": "Customer identifier", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "CUSTOMERID"}, {"name": "COUNTRY", "data_type": "VARCHAR(3)", "description": "Country code", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "COUNTRY"}, {"name": "CUSTOMERSEGMENT", "data_type": "VARCHAR(50)", "description": "Customer segment classification", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "CUSTOMERSEGMENT"}, {"name": "DEMANDFAMILY", "data_type": "VARCHAR(50)", "description": "Demand family classification", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "DEMANDFAMILY"}, {"name": "SUBREGION", "data_type": "VARCHAR(50)", "description": "Subregion classification (from industry)", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "SUBREGION"}, {"name": "INDUSTRY1_COLUMN1", "data_type": "VARCHAR(255)", "description": "Industry-specific value 1", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "INDUSTRY1_COLUMN1"}, {"name": "INDUSTRY1_COLUMN2", "data_type": "VARCHAR(255)", "description": "Industry-specific value 2", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "INDUSTRY1_COLUMN2"}, {"name": "INDUSTRY1_COLUMN3", "data_type": "VARCHAR(255)", "description": "Industry-specific value 3 (conditional)", "reference_table": "FCT_FORECASTITEM_silver_industry", "expression": "INDUSTRY1_COLUMN3"}], "audits": [], "grain": ["PK_FORECASTITEM_ID"]}, "customer_industry_values_cte": {"name": "customer_industry_values_cte", "description": "CTE for industry values filtered for customer-specific records", "layer": "cte", "kind": "CTE", "owner": "customer_team", "domain": "customer", "tags": ["customer", "industry", "cte", "filtered"], "refresh_frequency": "daily", "depends_on": ["IndustryTable"], "base_table": "IndustryTable", "columns": [{"name": "FORECASTITEMID", "data_type": "VARCHAR(50)", "description": "Forecast item identifier for joining", "reference_table": "IndustryTable", "expression": "FORECASTITEMID"}, {"name": "value1", "data_type": "VARCHAR(255)", "description": "Industry value 1", "reference_table": "IndustryTable", "expression": "value1"}, {"name": "value2", "data_type": "VARCHAR(255)", "description": "Industry value 2", "reference_table": "IndustryTable", "expression": "Value2"}, {"name": "value3", "data_type": "VARCHAR(255)", "description": "Industry value 3", "reference_table": "IndustryTable", "expression": "Value3"}, {"name": "Alterative_subregion", "data_type": "VARCHAR(50)", "description": "Alternative subregion classification", "reference_table": "IndustryTable", "expression": "Alterative_subregion"}], "audits": [], "grain": []}, "FCT_DEMAND_SUMMARY_gold_customer": {"name": "FCT_DEMAND_SUMMARY_gold_customer", "description": "Customer demand summary aggregated by month and customer segment", "layer": "gold", "kind": "TABLE", "owner": "customer_analytics_team", "domain": "customer", "tags": ["demand", "summary", "aggregation", "gold", "customer"], "refresh_frequency": "daily", "depends_on": ["FCT_DEMANDSTORAGE_silver_product", "FCT_FORECASTCYCLE_silver_industry", "FCT_FORECASTITEM_silver_customer"], "base_table": null, "columns": [{"name": "forecast_month", "data_type": "VARCHAR(7)", "description": "Forecast month in YYYY-MM format", "reference_table": "FCT_FORECASTCYCLE_silver_industry", "expression": "ForecastCycle_Label"}, {"name": "customer_segment", "data_type": "VARCHAR(50)", "description": "Customer segment classification", "reference_table": "FCT_FORECASTITEM_silver_customer", "expression": "CUSTOMERSEGMENT"}, {"name": "country", "data_type": "VARCHAR(3)", "description": "Country code", "reference_table": "FCT_FORECASTITEM_silver_customer", "expression": "COUNTRY"}, {"name": "demand_family", "data_type": "VARCHAR(50)", "description": "Demand family classification", "reference_table": "FCT_FORECASTITEM_silver_customer", "expression": "DEMANDFAMILY"}, {"name": "total_base_quantity", "data_type": "DECIMAL(18,2)", "description": "Total base quantity demand", "reference_table": "FCT_DEMANDSTORAGE_silver_product", "expression": "SUM(BASEQUANTITY)"}, {"name": "total_calculated_quantity", "data_type": "DECIMAL(18,2)", "description": "Total calculated quantity after adjustments", "reference_table": "FCT_DEMANDSTORAGE_silver_product", "expression": "SUM(CalculatedQuantity)"}, {"name": "item_count", "data_type": "INTEGER", "description": "Number of unique forecast items", "reference_table": "FCT_FORECASTITEM_silver_customer", "expression": "COUNT(DISTINCT FORECASTITEMID)"}, {"name": "customer_count", "data_type": "INTEGER", "description": "Number of unique customers", "reference_table": "FCT_FORECASTITEM_silver_customer", "expression": "COUNT(DISTINCT CUSTOMERID)"}, {"name": "avg_quantity_per_item", "data_type": "DECIMAL(18,2)", "description": "Average quantity per forecast item", "reference_table": "FCT_DEMANDSTORAGE_silver_product", "expression": "SUM(BASEQUANTITY) / NULLIF(COUNT(DISTINCT fi.FORECASTITEMID), 0)"}], "audits": [], "grain": ["forecast_month", "customer_segment", "country", "demand_family"]}};
        
        var container = document.getElementById('network');
        var data = { nodes: nodes, edges: edges };
        var options = {
            layout: {
                hierarchical: {
                    direction: 'LR',
                    sortMethod: 'directed',
                    levelSeparation: 150,
                    nodeSpacing: 100
                }
            },
            physics: {
                enabled: true,
                hierarchicalRepulsion: {
                    centralGravity: 0.0,
                    springLength: 100,
                    springConstant: 0.01,
                    nodeDistance: 120,
                    damping: 0.09
                },
                maxVelocity: 50,
                solver: 'hierarchicalRepulsion',
                timestep: 0.35,
                stabilization: {iterations: 150}
            },
            interaction: {
                dragNodes: true,
                dragView: true,
                zoomView: true
            }
        };
        
        var network = new vis.Network(container, data, options);
        
        // Populate model select dropdown
        var modelSelect = document.getElementById('modelSelect');
        Object.keys(modelsInfo).sort().forEach(function(modelName) {
            var option = document.createElement('option');
            option.value = modelName;
            option.textContent = modelName;
            modelSelect.appendChild(option);
        });
        
        // Event listener for node clicks
        network.on("click", function (params) {
            if (params.nodes.length > 0) {
                var modelName = params.nodes[0];
                showModelDetails(modelName);
            }
        });
        
        function showModelDetails(modelName) {
            var model = modelsInfo[modelName];
            if (!model) return;
            
            var html = '<div class="model-info">';
            html += '<h4>' + model.name + '</h4>';
            html += '<p><strong>Description:</strong> ' + (model.description || 'N/A') + '</p>';
            html += '<p><strong>Layer:</strong> ' + model.layer + '</p>';
            html += '<p><strong>Kind:</strong> ' + model.kind + '</p>';
            html += '<p><strong>Owner:</strong> ' + model.owner + '</p>';
            html += '<p><strong>Domain:</strong> ' + model.domain + '</p>';
            html += '<p><strong>Refresh Frequency:</strong> ' + model.refresh_frequency + '</p>';
            
            if (model.depends_on && model.depends_on.length > 0) {
                html += '<p><strong>Dependencies:</strong> ' + model.depends_on.join(', ') + '</p>';
            }
            
            if (model.columns && model.columns.length > 0) {
                html += '<p><strong>Columns (' + model.columns.length + '):</strong></p>';
                html += '<div class="column-list"><ul>';
                model.columns.forEach(function(col) {
                    html += '<li><strong>' + col.name + '</strong> (' + col.data_type + ')';
                    if (col.description) {
                        html += ' - ' + col.description;
                    }
                    html += '</li>';
                });
                html += '</ul></div>';
            }
            
            html += '</div>';
            
            document.getElementById('model-details').innerHTML = html;
        }
        
        function fitNetwork() {
            network.fit();
        }
        
        function showAllNodes() {
            nodes.clear();
            nodes.add([{"id": "fct_forecastitem", "label": "fct_forecastitem", "title": "<b>fct_forecastitem</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast item data from source system<br>Columns: 18", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_demandstorage", "label": "fct_demandstorage", "title": "<b>fct_demandstorage</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: demand<br>Description: Raw demand storage fact table from source system<br>Columns: 5", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_ForecastCycle", "label": "fct_ForecastCycle", "title": "<b>fct_ForecastCycle</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast cycle data from source system<br>Columns: 3", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "IndustryTable", "label": "IndustryTable", "title": "<b>IndustryTable</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: industry<br>Description: Raw industry reference data from source system<br>Columns: 6", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_ForeCastGroup", "label": "fct_ForeCastGroup", "title": "<b>fct_ForeCastGroup</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast group data from source system<br>Columns: 2", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTGROUP_silver_product", "label": "FCT_FORECASTGROUP_silver_product", "title": "<b>FCT_FORECASTGROUP_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast groups<br>Columns: 2", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_DEMANDSTORAGE_silver_product", "label": "FCT_DEMANDSTORAGE_silver_product", "title": "<b>FCT_DEMANDSTORAGE_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized demand storage<br>Columns: 5", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_product", "label": "FCT_FORECASTITEM_silver_product", "title": "<b>FCT_FORECASTITEM_silver_product</b><br>Layer: silver<br>Kind: TABLE<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast items<br>Columns: 18", "group": "silver", "shape": "box", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTCYCLE_silver_product", "label": "FCT_FORECASTCYCLE_silver_product", "title": "<b>FCT_FORECASTCYCLE_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast cycles<br>Columns: 3", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_industry", "label": "FCT_FORECASTITEM_silver_industry", "title": "<b>FCT_FORECASTITEM_silver_industry</b><br>Layer: silver<br>Kind: VIEW<br>Owner: industry_team<br>Domain: industry<br>Description: Industry vertical silver layer - adds industry-specific attributes to forecast items<br>Columns: 11", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTCYCLE_silver_industry", "label": "FCT_FORECASTCYCLE_silver_industry", "title": "<b>FCT_FORECASTCYCLE_silver_industry</b><br>Layer: silver<br>Kind: VIEW<br>Owner: industry_team<br>Domain: industry<br>Description: Industry vertical silver layer - adds industry-specific forecast cycle attributes<br>Columns: 4", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "industry_values_cte", "label": "industry_values_cte", "title": "<b>industry_values_cte</b><br>Layer: cte<br>Kind: CTE<br>Owner: industry_team<br>Domain: industry<br>Description: CTE for industry-specific values and alternative subregion mapping<br>Columns: 5", "group": "cte", "shape": "diamond", "color": "#D3D3D3", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_customer", "label": "FCT_FORECASTITEM_silver_customer", "title": "<b>FCT_FORECASTITEM_silver_customer</b><br>Layer: silver<br>Kind: VIEW<br>Owner: customer_team<br>Domain: customer<br>Description: Customer vertical silver layer - applies customer-specific filtering to industry data<br>Columns: 11", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "customer_industry_values_cte", "label": "customer_industry_values_cte", "title": "<b>customer_industry_values_cte</b><br>Layer: cte<br>Kind: CTE<br>Owner: customer_team<br>Domain: customer<br>Description: CTE for industry values filtered for customer-specific records<br>Columns: 5", "group": "cte", "shape": "diamond", "color": "#D3D3D3", "font": {"size": 12}, "physics": true}, {"id": "FCT_DEMAND_SUMMARY_gold_customer", "label": "FCT_DEMAND_SUMMARY_gold_customer", "title": "<b>FCT_DEMAND_SUMMARY_gold_customer</b><br>Layer: gold<br>Kind: TABLE<br>Owner: customer_analytics_team<br>Domain: customer<br>Description: Customer demand summary aggregated by month and customer segment<br>Columns: 9", "group": "gold", "shape": "box", "color": "#FFD700", "font": {"size": 12}, "physics": true}]);
            edges.clear();
            edges.add([{"id": 0, "from": "fct_ForeCastGroup", "to": "FCT_FORECASTGROUP_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForeCastGroup \u2192 FCT_FORECASTGROUP_silver_product"}, {"id": 1, "from": "fct_demandstorage", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_demandstorage \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 2, "from": "fct_ForecastCycle", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForecastCycle \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 3, "from": "fct_ForeCastGroup", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForeCastGroup \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 4, "from": "fct_forecastitem", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 5, "from": "fct_forecastitem", "to": "FCT_FORECASTITEM_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_FORECASTITEM_silver_product"}, {"id": 6, "from": "fct_ForecastCycle", "to": "FCT_FORECASTCYCLE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForecastCycle \u2192 FCT_FORECASTCYCLE_silver_product"}, {"id": 7, "from": "FCT_FORECASTITEM_silver_product", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_product \u2192 FCT_FORECASTITEM_silver_industry"}, {"id": 8, "from": "IndustryTable", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 FCT_FORECASTITEM_silver_industry"}, {"id": 9, "from": "industry_values_cte", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#2E86C1"}, "width": 2, "title": "industry_values_cte \u2192 FCT_FORECASTITEM_silver_industry (CTE)", "dashes": true}, {"id": 10, "from": "FCT_FORECASTCYCLE_silver_product", "to": "FCT_FORECASTCYCLE_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTCYCLE_silver_product \u2192 FCT_FORECASTCYCLE_silver_industry"}, {"id": 11, "from": "IndustryTable", "to": "industry_values_cte", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 industry_values_cte"}, {"id": 12, "from": "FCT_FORECASTITEM_silver_industry", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_industry \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 13, "from": "fct_forecastitem", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 14, "from": "IndustryTable", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 15, "from": "customer_industry_values_cte", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#2E86C1"}, "width": 2, "title": "customer_industry_values_cte \u2192 FCT_FORECASTITEM_silver_customer (CTE)", "dashes": true}, {"id": 16, "from": "IndustryTable", "to": "customer_industry_values_cte", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 customer_industry_values_cte"}, {"id": 17, "from": "FCT_DEMANDSTORAGE_silver_product", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_DEMANDSTORAGE_silver_product \u2192 FCT_DEMAND_SUMMARY_gold_customer"}, {"id": 18, "from": "FCT_FORECASTCYCLE_silver_industry", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTCYCLE_silver_industry \u2192 FCT_DEMAND_SUMMARY_gold_customer"}, {"id": 19, "from": "FCT_FORECASTITEM_silver_customer", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_customer \u2192 FCT_DEMAND_SUMMARY_gold_customer"}]);
        }
        
        function filterByLayer() {
            var selectedLayer = document.getElementById('layerFilter').value;
            
            if (selectedLayer === '') {
                showAllNodes();
                return;
            }
            
            var filteredNodes = [{"id": "fct_forecastitem", "label": "fct_forecastitem", "title": "<b>fct_forecastitem</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast item data from source system<br>Columns: 18", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_demandstorage", "label": "fct_demandstorage", "title": "<b>fct_demandstorage</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: demand<br>Description: Raw demand storage fact table from source system<br>Columns: 5", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_ForecastCycle", "label": "fct_ForecastCycle", "title": "<b>fct_ForecastCycle</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast cycle data from source system<br>Columns: 3", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "IndustryTable", "label": "IndustryTable", "title": "<b>IndustryTable</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: industry<br>Description: Raw industry reference data from source system<br>Columns: 6", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "fct_ForeCastGroup", "label": "fct_ForeCastGroup", "title": "<b>fct_ForeCastGroup</b><br>Layer: bronze<br>Kind: TABLE<br>Owner: data_engineering<br>Domain: tbd<br>Description: Raw forecast group data from source system<br>Columns: 2", "group": "bronze", "shape": "box", "color": "#87CEEB", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTGROUP_silver_product", "label": "FCT_FORECASTGROUP_silver_product", "title": "<b>FCT_FORECASTGROUP_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast groups<br>Columns: 2", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_DEMANDSTORAGE_silver_product", "label": "FCT_DEMANDSTORAGE_silver_product", "title": "<b>FCT_DEMANDSTORAGE_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized demand storage<br>Columns: 5", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_product", "label": "FCT_FORECASTITEM_silver_product", "title": "<b>FCT_FORECASTITEM_silver_product</b><br>Layer: silver<br>Kind: TABLE<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast items<br>Columns: 18", "group": "silver", "shape": "box", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTCYCLE_silver_product", "label": "FCT_FORECASTCYCLE_silver_product", "title": "<b>FCT_FORECASTCYCLE_silver_product</b><br>Layer: silver<br>Kind: VIEW<br>Owner: product_team<br>Domain: product<br>Description: Product vertical silver layer - standardized forecast cycles<br>Columns: 3", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_industry", "label": "FCT_FORECASTITEM_silver_industry", "title": "<b>FCT_FORECASTITEM_silver_industry</b><br>Layer: silver<br>Kind: VIEW<br>Owner: industry_team<br>Domain: industry<br>Description: Industry vertical silver layer - adds industry-specific attributes to forecast items<br>Columns: 11", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTCYCLE_silver_industry", "label": "FCT_FORECASTCYCLE_silver_industry", "title": "<b>FCT_FORECASTCYCLE_silver_industry</b><br>Layer: silver<br>Kind: VIEW<br>Owner: industry_team<br>Domain: industry<br>Description: Industry vertical silver layer - adds industry-specific forecast cycle attributes<br>Columns: 4", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "industry_values_cte", "label": "industry_values_cte", "title": "<b>industry_values_cte</b><br>Layer: cte<br>Kind: CTE<br>Owner: industry_team<br>Domain: industry<br>Description: CTE for industry-specific values and alternative subregion mapping<br>Columns: 5", "group": "cte", "shape": "diamond", "color": "#D3D3D3", "font": {"size": 12}, "physics": true}, {"id": "FCT_FORECASTITEM_silver_customer", "label": "FCT_FORECASTITEM_silver_customer", "title": "<b>FCT_FORECASTITEM_silver_customer</b><br>Layer: silver<br>Kind: VIEW<br>Owner: customer_team<br>Domain: customer<br>Description: Customer vertical silver layer - applies customer-specific filtering to industry data<br>Columns: 11", "group": "silver", "shape": "ellipse", "color": "#98FB98", "font": {"size": 12}, "physics": true}, {"id": "customer_industry_values_cte", "label": "customer_industry_values_cte", "title": "<b>customer_industry_values_cte</b><br>Layer: cte<br>Kind: CTE<br>Owner: customer_team<br>Domain: customer<br>Description: CTE for industry values filtered for customer-specific records<br>Columns: 5", "group": "cte", "shape": "diamond", "color": "#D3D3D3", "font": {"size": 12}, "physics": true}, {"id": "FCT_DEMAND_SUMMARY_gold_customer", "label": "FCT_DEMAND_SUMMARY_gold_customer", "title": "<b>FCT_DEMAND_SUMMARY_gold_customer</b><br>Layer: gold<br>Kind: TABLE<br>Owner: customer_analytics_team<br>Domain: customer<br>Description: Customer demand summary aggregated by month and customer segment<br>Columns: 9", "group": "gold", "shape": "box", "color": "#FFD700", "font": {"size": 12}, "physics": true}].filter(function(node) {
                return node.group === selectedLayer;
            });
            
            var nodeIds = filteredNodes.map(function(node) { return node.id; });
            var filteredEdges = [{"id": 0, "from": "fct_ForeCastGroup", "to": "FCT_FORECASTGROUP_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForeCastGroup \u2192 FCT_FORECASTGROUP_silver_product"}, {"id": 1, "from": "fct_demandstorage", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_demandstorage \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 2, "from": "fct_ForecastCycle", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForecastCycle \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 3, "from": "fct_ForeCastGroup", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForeCastGroup \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 4, "from": "fct_forecastitem", "to": "FCT_DEMANDSTORAGE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_DEMANDSTORAGE_silver_product"}, {"id": 5, "from": "fct_forecastitem", "to": "FCT_FORECASTITEM_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_FORECASTITEM_silver_product"}, {"id": 6, "from": "fct_ForecastCycle", "to": "FCT_FORECASTCYCLE_silver_product", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_ForecastCycle \u2192 FCT_FORECASTCYCLE_silver_product"}, {"id": 7, "from": "FCT_FORECASTITEM_silver_product", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_product \u2192 FCT_FORECASTITEM_silver_industry"}, {"id": 8, "from": "IndustryTable", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 FCT_FORECASTITEM_silver_industry"}, {"id": 9, "from": "industry_values_cte", "to": "FCT_FORECASTITEM_silver_industry", "arrows": "to", "color": {"color": "#2E86C1"}, "width": 2, "title": "industry_values_cte \u2192 FCT_FORECASTITEM_silver_industry (CTE)", "dashes": true}, {"id": 10, "from": "FCT_FORECASTCYCLE_silver_product", "to": "FCT_FORECASTCYCLE_silver_industry", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTCYCLE_silver_product \u2192 FCT_FORECASTCYCLE_silver_industry"}, {"id": 11, "from": "IndustryTable", "to": "industry_values_cte", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 industry_values_cte"}, {"id": 12, "from": "FCT_FORECASTITEM_silver_industry", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_industry \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 13, "from": "fct_forecastitem", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "fct_forecastitem \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 14, "from": "IndustryTable", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 FCT_FORECASTITEM_silver_customer"}, {"id": 15, "from": "customer_industry_values_cte", "to": "FCT_FORECASTITEM_silver_customer", "arrows": "to", "color": {"color": "#2E86C1"}, "width": 2, "title": "customer_industry_values_cte \u2192 FCT_FORECASTITEM_silver_customer (CTE)", "dashes": true}, {"id": 16, "from": "IndustryTable", "to": "customer_industry_values_cte", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "IndustryTable \u2192 customer_industry_values_cte"}, {"id": 17, "from": "FCT_DEMANDSTORAGE_silver_product", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_DEMANDSTORAGE_silver_product \u2192 FCT_DEMAND_SUMMARY_gold_customer"}, {"id": 18, "from": "FCT_FORECASTCYCLE_silver_industry", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTCYCLE_silver_industry \u2192 FCT_DEMAND_SUMMARY_gold_customer"}, {"id": 19, "from": "FCT_FORECASTITEM_silver_customer", "to": "FCT_DEMAND_SUMMARY_gold_customer", "arrows": "to", "color": {"color": "#848484"}, "width": 2, "title": "FCT_FORECASTITEM_silver_customer \u2192 FCT_DEMAND_SUMMARY_gold_customer"}].filter(function(edge) {
                return nodeIds.includes(edge.from) && nodeIds.includes(edge.to);
            });
            
            nodes.clear();
            nodes.add(filteredNodes);
            edges.clear();
            edges.add(filteredEdges);
        }
        
        function focusOnModel() {
            var selectedModel = document.getElementById('modelSelect').value;
            if (selectedModel === '') return;
            
            network.focus(selectedModel, {
                scale: 1.0,
                animation: {
                    duration: 1000,
                    easingFunction: 'easeInOutQuad'
                }
            });
            
            showModelDetails(selectedModel);
        }
    </script>
</body>
</html>